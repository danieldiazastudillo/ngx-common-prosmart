<div class="row justify-content-center bg-dark-subtle border border-2 shadow my-3 p-4 rounded-2">
  <div class="col">
    <h2>ngx-rut-v2</h2>
    <p>Valida y formatea RUT (Rol √önico Tributario) chileno. Incluye validaci√≥n para formularios reactivos y formateo autom√°tico en inputs.</p>

    <pre class="shadow-lg my-3 rounded-3">
      <code [highlight]="bash" language="bash"></code>
    </pre>
  </div>
  <div class="col">
    <h4>‚úÖ Implementaci√≥n Recomendada (RutValueAccessor)</h4>
    <form [formGroup]="form">
      <label for="rut" class="form-label">RUT (Rol √önico Tributario):</label>
      <input class="form-control form-control-lg" formControlName="rut" id="rut" formatRut />
      @if (form.get('rut')?.hasError('required') && form.get('rut')?.touched) {
        <div class="text-danger mt-2">El RUT es requerido</div>
      }
      @if (form.get('rut')?.hasError('invalidRut') && form.get('rut')?.touched) {
        <div class="text-danger mt-2">El RUT ingresado es <strong>inv√°lido</strong></div>
      }
      @if (form.get('rut')?.valid && form.get('rut')?.value && form.get('rut')?.touched) {
        <div class="text-success mt-2">‚úì El RUT es <strong>v√°lido</strong></div>
      }
    </form>

    <div class="mt-3">
      <button class="btn btn-primary btn-sm" type="button" (click)="onSimulateProgrammaticUpdate()">
        üß™ Test Programmatic Update
      </button>
      <p class="text-muted small mt-2">Click to test setValue() while input is focused</p>
    </div>

    <div class="mt-3">
      <p><strong>Valor del formulario:</strong></p>
      <pre class="shadow-lg my-3 rounded-3">
        <code [highlight]="form.value | json" language="json" lineNumbers></code>
      </pre>
      <p><strong>RUT Formateado (con pipe):</strong> {{ (form.get('rut')?.value || '') | rut }}</p>
    </div>
  </div>
</div>

<div class="row justify-content-center bg-warning-subtle border border-warning border-2 shadow my-3 p-4 rounded-2">
  <div class="col">
    <h4>‚ö†Ô∏è Implementaci√≥n Deprecada (formatRutLegacy)</h4>
    <div class="alert alert-warning" role="alert">
      <strong>DEPRECATION WARNING:</strong> The <code>[formatRutLegacy]</code> directive is deprecated and will be removed in v3.0.0.
      Please migrate to <code>[formatRut]</code> with form controls (see recommended implementation above).
      Check browser console for deprecation warnings.
    </div>

    <form [formGroup]="deprecatedForm">
      <label for="rut-deprecated" class="form-label">RUT (usando formatRutLegacy - Deprecated):</label>
      <input class="form-control form-control-lg" formControlName="rut" id="rut-deprecated" formatRutLegacy />
      @if (deprecatedForm.get('rut')?.hasError('invalidRut') && deprecatedForm.get('rut')?.touched) {
        <div class="text-danger mt-2">El RUT ingresado es <strong>inv√°lido</strong></div>
      }
    </form>

    <div class="mt-3">
      <button class="btn btn-warning btn-sm" type="button" (click)="onSimulateDeprecatedUpdate()">
        ‚ö†Ô∏è Test Deprecated Directive
      </button>
      <p class="text-muted small mt-2">This will trigger console warning</p>
    </div>

    <pre class="shadow-lg my-3 rounded-3">
      <code [highlight]="deprecatedExample" language="html" lineNumbers></code>
    </pre>
  </div>
</div>

<div class="row justify-content-center my-3">
  <div class="col">
    <h4>Implementaci√≥n:</h4>
    <p><small>La directiva de formateo es <strong>formatRut</strong> y la validaci√≥n se hace con <strong>rutValidator</strong></small></p>
    <pre class="shadow-lg my-3 rounded-3">
      <code [highlight]="textoImplementacion" language="ts" lineNumbers></code>
    </pre>

    <pre class="shadow-lg my-3 rounded-3">
      <code [highlight]="textoTemplate" language="html" lineNumbers></code>
    </pre>
  </div>
</div>
